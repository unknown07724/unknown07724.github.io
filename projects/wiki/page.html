<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Memepedia - Page</title>
<link rel="icon" href="favicon.png">
<style>
  body { margin: 0; display: flex; font-family: Arial, sans-serif; height: 100vh; }
  #sidebar { width: 250px; background: #eee; padding: 15px; box-sizing: border-box; overflow-y: auto; }
  #sidebar h2 { margin-top: 0; }
  #sidebar a, #sidebar button { display: block; padding: 8px; margin: 5px 0; text-decoration: none; background: #ddd; border: none; border-radius: 5px; color: black; cursor: pointer; }
  #sidebar a:hover, #sidebar button:hover { background: #ccc; }
  #content { flex: 1; border: none; height: 100%; }
</style>
</head>
<body>

<div id="sidebar">
  <img src="logo.svg" alt="Memepedia logo" width="175" height="175">
  <a href="main.html">Main page</a>
  <a href="edit.html">Create a page</a>
  <button id="editBtn">Edit This Page</button>
  <a href="upload.html">Upload Image</a>
  <a href="random.html" id="randomPageLink">Random Page</a>
</div>

<iframe id="content" src="" name="contentFrame"></iframe>

<script>
const githubBase = 'https://unknown07724.github.io/projects/wiki/pages/';

// Get the page from URL search param
function getPageParam() {
  const params = new URLSearchParams(window.location.search);
  return params.get('page') || 'memepedia'; // default page
}

// Update the URL without reloading
function updateUrl(page) {
  const url = new URL(window.location);
  url.searchParams.set('page', page);
  window.history.replaceState({}, '', url);
}

// Load the page in the iframe
function loadPage(page = null) {
  if (typeof page !== 'string' || !page) page = getPageParam();
  const iframe = document.getElementById('content');
  iframe.src = `${githubBase}${page}.html`;
  updateUrl(page);
}

// Edit button opens edit.html for the current page
document.getElementById('editBtn').addEventListener('click', () => {
  const page = getPageParam();
  window.open(`edit.html?page=${page}`, '_blank');
});

// Global hard redirect helper (for article-level redirects)
window.redirect = function(page) {
  if (!page) return;
  loadPage(page);
};

// Initialize iframe on page load
window.addEventListener('load', () => loadPage());

// Fix popstate listener to prevent passing Event object
window.addEventListener('popstate', () => loadPage());
</script>

</body>
</html>

