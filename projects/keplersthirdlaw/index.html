<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Planetary Orbital Radius Calculator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    margin: 0;
    padding: 0;
  }
  #app {
    max-width: 900px;
    margin: 40px auto;
    background: #fff;
    padding: 24px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.07);
    display: flex;
    gap: 24px;
  }
  #inputs {
    flex: 1;
  }
  #orbitCanvas {
    width: 300px;
    height: 300px;
    border: 1px solid #ccc;
    border-radius: 6px;
    background: #f6f8fa;
  }
  input, select, button {
    font-size: 1rem;
    margin-bottom: 10px;
    width: 100%;
  }
  label {
    display: block;
    margin-bottom: 12px;
  }
  button {
    cursor: pointer;
    background: #2196F3;
    color: white;
    border: none;
    padding: 8px;
    border-radius: 4px;
  }
  button:hover {
    background: #1769aa;
  }
  .result {
    margin-top: 22px;
    background: #f6f8fa;
    border: 1px solid #b3c0d3;
    border-radius: 6px;
    padding: 16px;
  }
</style>
</head>
<body>
<div id="app">
  <div id="inputs">
    <h2>Planetary Orbital Radius Calculator</h2>
    <label for="examplePlanet">
      Example Planet:<br>
      <select id="examplePlanet">
        <option value="">-- Select Example Planet --</option>
      </select>
    </label>
    <label for="yearLength">
      Planet Year Length (in 24-hour Earth days):<br>
      <input type="number" id="yearLength" value="365" min="1">
    </label>
    <label for="starClass">
      Star Class:<br>
      <select id="starClass"></select>
    </label>
    <label for="eccentricity">
      Orbital Eccentricity (optional, 0–1):<br>
      <input type="number" id="eccentricity" step="0.001" min="0" max="1">
    </label>
    <button id="calcBtn">Calculate</button>
    <div id="result"></div>
  </div>
  <canvas id="orbitCanvas" width="300" height="300"></canvas>
</div>

<script>
const starData = {
  "M": { mass: 0.5, luminosity: 0.05 },
  "K": { mass: 0.8, luminosity: 0.4 },
  "G": { mass: 1, luminosity: 1 },
  "F": { mass: 1.3, luminosity: 5 },
  "A": { mass: 2, luminosity: 25 }
};

let examplePlanets = [];

function orbitalRadiusAU(yearLength, starMass) {
  const TEarth = 365;
  return Math.pow(Math.pow(yearLength / TEarth, 2) * starMass, 1/3);
}

function perihelionAU(a, e) { return a * (1 - e); }
function aphelionAU(a, e) { return a * (1 + e); }

function populateDropdowns() {
  const exampleSelect = document.getElementById('examplePlanet');
  examplePlanets.forEach(p => {
    const opt = document.createElement('option');
    opt.value = p.name;
    opt.textContent = p.name;
    exampleSelect.appendChild(opt);
  });

  const starSelect = document.getElementById('starClass');
  Object.keys(starData).forEach(cls => {
    const opt = document.createElement('option');
    opt.value = cls;
    opt.textContent = cls;
    starSelect.appendChild(opt);
  });
}

function drawOrbit(aAU, e) {
  const canvas = document.getElementById('orbitCanvas');
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const centerX = canvas.width / 2;
  const centerY = canvas.height / 2;
  const scale = 100; // 1 AU = 100 px
  const rx = aAU * scale;
  const ry = rx * Math.sqrt(1 - e*e);

  // Draw star
  ctx.fillStyle = "#FFD700";
  ctx.beginPath();
  ctx.arc(centerX, centerY, 6, 0, Math.PI*2);
  ctx.fill();

  // Draw orbit ellipse
  ctx.strokeStyle = "#2196F3";
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.ellipse(centerX - e*rx, centerY, rx, ry, 0, 0, Math.PI*2);
  ctx.stroke();
}

function calculate() {
  const yearLength = Number(document.getElementById('yearLength').value);
  const starClass = document.getElementById('starClass').value;
  const eccentricityInput = document.getElementById('eccentricity').value;

  if (yearLength <= 0) { alert("Year length must be positive."); return; }
  let ecc = eccentricityInput === "" ? 0 : Number(eccentricityInput);
  if (ecc < 0 || ecc > 1) { alert("Eccentricity must be 0–1."); return; }

  const starMass = starData[starClass].mass;
  const a = orbitalRadiusAU(yearLength, starMass);
  const peri = perihelionAU(a, ecc);
  const aphe = aphelionAU(a, ecc);

  document.getElementById('result').innerHTML = `
    <div class="result">
      <strong>Orbital radius (a):</strong> ${a.toFixed(4)} AU<br>
      <strong>Perihelion:</strong> ${peri.toFixed(4)} AU<br>
      <strong>Aphelion:</strong> ${aphe.toFixed(4)} AU
    </div>
  `;

  drawOrbit(a, ecc);
}

document.addEventListener('DOMContentLoaded', () => {
  fetch('planets.json')
    .then(res => res.json())
    .then(data => {
      examplePlanets = data;
      populateDropdowns();
      calculate();
    });

  const exampleDropdown = document.getElementById('examplePlanet');
  exampleDropdown.addEventListener('change', () => {
    const selected = examplePlanets.find(p => p.name === exampleDropdown.value);
    if (!selected) return;
    document.getElementById('yearLength').value = selected.yearLength;
    document.getElementById('starClass').value = selected.starClass;
    document.getElementById('eccentricity').value = selected.eccentricity;
    calculate();
  });

  document.getElementById('calcBtn').addEventListener('click', calculate);
});
</script>
</body>
</html>
