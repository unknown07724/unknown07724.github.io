<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="styles.css">
    <script src="settings-apply.js"></script>
</head>
<body>
    <header>
        <h1>Admin Panel</h1>
    </header>

    <main>
        <!-- IP to User ID Tool -->
        <section>
            <h2>IP to User ID</h2>
            <form id="ip-lookup-form">
                <input type="text" id="ip-input" placeholder="Enter IP Address" required>
                <button type="submit">Lookup User ID</button>
            </form>
            <p id="ip-lookup-result">Result: </p>
        </section>

        <!-- Post JSON Generator Tool -->
        <section>
            <h2>Post JSON Generator</h2>
            <form id="post-json-form">
                <input type="text" id="post-title" placeholder="Post Title" required><br>
                <textarea id="post-content" placeholder="Post Content" required></textarea><br>
                <input type="text" id="post-subreddit" placeholder="Subreddit" required><br>
                <button type="submit">Generate Post JSON</button>
            </form>
            <pre id="post-json-result">Generated JSON: </pre>
        </section>

        <!-- User Switcher Tool -->
        <section>
            <h2>Switch User</h2>
            <label for="user-select">Select User:</label>
            <select id="user-select">
                <option value="">Loading users...</option>
            </select>
            <button id="switch-user-btn">Switch User</button>
            <p id="switch-user-result"></p>
        </section>
    </main>

    <script>
        // Simulated Data for IP-to-User ID Mapping (optional)
        const ipToUserData = {
            "194.xxx.155.134": { id: "2", username: "ginger1488" },
            "87.xxx.4.181": { id: "3", username: "um" },
            "38.xxx.236.238": { id: "1", username: "unknown07724" }
        };

        // IP to User ID Lookup
        document.getElementById("ip-lookup-form").addEventListener("submit", (e) => {
            e.preventDefault();
            const ip = document.getElementById("ip-input").value.trim();
            const userData = ipToUserData[ip];

            if (userData) {
                document.getElementById("ip-lookup-result").innerText = `User ID: ${userData.id}, Username: ${userData.username}`;
            } else {
                document.getElementById("ip-lookup-result").innerText = "User not found";
            }
        });

        // Post JSON Generator
        document.getElementById("post-json-form").addEventListener("submit", (e) => {
            e.preventDefault();

            const title = document.getElementById("post-title").value.trim();
            const content = document.getElementById("post-content").value.trim();
            const subreddit = document.getElementById("post-subreddit").value.trim();

            if (!title || !content || !subreddit) {
                alert("All fields are required!");
                return;
            }

            const postJson = {
                id: crypto.randomUUID(),
                subreddit: subreddit,
                title: title,
                content: content,
                userID: "PLACEHOLDER_USER_ID", // Replace with actual logic
            };

            document.getElementById("post-json-result").innerText = JSON.stringify(postJson, null, 4);
        });

        // User Switcher Tool
        fetch('data/users.json')
            .then(res => res.json())
            .then(users => {
                const select = document.getElementById('user-select');
                select.innerHTML = ''; // Clear loading option
                users.forEach(user => {
                    const option = document.createElement('option');
                    option.value = user.id;
                    option.textContent = user.username; // Show username
                    select.appendChild(option);
                });
            })
            .catch(err => {
                console.error(err);
                document.getElementById('switch-user-result').innerText = 'Failed to load users.';
            });

        document.getElementById('switch-user-btn').addEventListener('click', () => {
            const select = document.getElementById('user-select');
            const userId = select.value;

            if (!userId) {
                document.getElementById('switch-user-result').innerText = 'Please select a user.';
                return;
            }

            localStorage.setItem('PB-userid', userId);
            document.getElementById('switch-user-result').innerText = `Switched to user: ${select.options[select.selectedIndex].text} (ID: ${userId})`;
        });
    </script>
</body>
</html>
